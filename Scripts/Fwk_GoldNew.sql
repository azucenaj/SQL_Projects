SELECT 'HH_ALLINK' AS [DATABASE],'ADMIN' AS [SCHEMA],'BDM_EXISTING_CUSTOMERS' AS TABLE_NAME,'GLBL_CSTMR_ID' AS KEY_COLUMN,'N' AS ACTIVE_FLAG,NULL AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,NULL AS PARTITION_ON,NULL AS PARTITION_QUERY_NETEZZA,NULL AS PARTITION_QUERY_SYNAPSE,NULL AS FIELD_VALIDATION_QUERY_NETEZZA,NULL AS FIELD_VALIDATION_QUERY_SYNAPSE,NULL AS MEASURE_QUERY_NETEZZA,NULL AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,NULL AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, NULL AS [ADLS_QUERY_FOR_FIELD], NULL AS [ADLS_QUERY_FOR_MEASURE]

--CUSTOMER_LINK--
UNION ALL SELECT 'STAGING' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_LINK' AS TABLE_NAME,'CSTMR_ID' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'SOURCE_CREATE_DATE' AS PARTITION_COLUMN,'DK' AS KEY_TYPE,'N' AS KEY_TYPE_UNIQUE,'MONTH'AS PARTITION_ON,'SELECT to_char(SOURCE_CREATE_DATE, ''YYYY Mon'') as SOURCE_CREATE_DATE,count(*) FROM STAGING..CUSTOMER_LINK  group by to_char(SOURCE_CREATE_DATE, ''YYYY Mon'') order by to_char(SOURCE_CREATE_DATE, ''YYYY Mon'') DESC' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM''), count(*) from delta.`/mnt/silver/STAGING/ADMIN/CUSTOMER_LINK` group by DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'') order by DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'') desc' AS PARTITION_QUERY_SYNAPSE,'select * from STAGING..CUSTOMER_LINK where to_char(SOURCE_CREATE_DATE, ''YYYY Mon'')=''2022 Dec''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/STAGING/ADMIN/CUSTOMER_LINK` where DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'')=''2022 Dec''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(SOURCE_CREATE_DATE, ''YYYY Mon'') AS SOURCE_CREATE_DATE,sum(CSTMR_SOURCE) as CSTMR_SOURCE FROM STAGING..CUSTOMER_LINK GROUP BY to_char(SOURCE_CREATE_DATE, ''YYYY Mon'')' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'') AS SOURCE_CREATE_DATE,sum(CSTMR_SOURCE) as CSTMR_SOURCE FROM delta.`/mnt/silver/STAGING/ADMIN/CUSTOMER_LINK/` GROUP BY DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'')' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_SOURCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df where DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'')=''2022 Dec''' AS [ADLS_QUERY_FOR_FIELD], 'SELECT DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'') AS SOURCE_CREATE_DATE,sum(CSTMR_SOURCE) as CSTMR_SOURCE FROM Data_Lake_df GROUP BY DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'')' AS [ADLS_QUERY_FOR_MEASURE]	
UNION ALL SELECT 'STAGING' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_LINK' AS TABLE_NAME,'DW_PRCSS_ID' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'SOURCE_CREATE_DATE' AS PARTITION_COLUMN,'DK' AS KEY_TYPE,'N' AS KEY_TYPE_UNIQUE,'MONTH'AS PARTITION_ON,'SELECT to_char(SOURCE_CREATE_DATE, ''YYYY Mon'') as SOURCE_CREATE_DATE,count(*) FROM STAGING..CUSTOMER_LINK  group by to_char(SOURCE_CREATE_DATE, ''YYYY Mon'') order by to_char(SOURCE_CREATE_DATE, ''YYYY Mon'') DESC' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM''), count(*) from delta.`/mnt/silver/STAGING/ADMIN/CUSTOMER_LINK` group by DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'') order by DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'') desc' AS PARTITION_QUERY_SYNAPSE,'select * from STAGING..CUSTOMER_LINK where to_char(SOURCE_CREATE_DATE, ''YYYY Mon'')=''2022 Dec''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/STAGING/ADMIN/CUSTOMER_LINK` where DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'')=''2022 Dec''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(SOURCE_CREATE_DATE, ''YYYY Mon'') AS SOURCE_CREATE_DATE,sum(CSTMR_SOURCE) as CSTMR_SOURCE FROM STAGING..CUSTOMER_LINK GROUP BY to_char(SOURCE_CREATE_DATE, ''YYYY Mon'')' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'') AS SOURCE_CREATE_DATE,sum(CSTMR_SOURCE) as CSTMR_SOURCE FROM delta.`/mnt/silver/STAGING/ADMIN/CUSTOMER_LINK/` GROUP BY DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'')' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_SOURCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df where DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'')=''2022 Dec''' AS [ADLS_QUERY_FOR_FIELD], 'SELECT DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'') AS SOURCE_CREATE_DATE,sum(CSTMR_SOURCE) as CSTMR_SOURCE FROM Data_Lake_df GROUP BY DATE_FORMAT(SOURCE_CREATE_DATE, ''yyyy MMM'')' AS [ADLS_QUERY_FOR_MEASURE]	

--CUSTOMER_ACCOUNT_HIST 1503,1504 corrected --
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_ACCOUNT_HIST' AS TABLE_NAME,'EFFCTV_DATE' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'CSTMR_ACCNT_CREATE_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'YEAR' AS PARTITION_ON,'SELECT to_char(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') AS CSTMR_ACCNT_CREATE_DATE, count(*) FROM WAREHOUSE.ADMIN.CUSTOMER_ACCOUNT_HIST GROUP BY to_char(CSTMR_ACCNT_CREATE_DATE, ''yyyy'')' AS PARTITION_QUERY_NETEZZA,'SELECT DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') AS CSTMR_ACCNT_CREATE_DATE, count(*) FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ACCOUNT_HIST/` GROUP BY DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'')' AS PARTITION_QUERY_SYNAPSE,'SELECT * FROM WAREHOUSE.ADMIN.CUSTOMER_ACCOUNT_HIST WHERE to_char(CSTMR_ACCNT_CREATE_DATE, ''YYYY'') = ''2018''' AS FIELD_VALIDATION_QUERY_NETEZZA,'SELECT * FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ACCOUNT_HIST/` WHERE DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') = ''2018''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') AS CSTMR_ACCNT_CREATE_DATE, sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM WAREHOUSE..CUSTOMER_ACCOUNT_HIST GROUP BY to_char(CSTMR_ACCNT_CREATE_DATE, ''yyyy''), DW_PRCSS_ID' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') AS CSTMR_ACCNT_CREATE_DATE,sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ACCOUNT/` GROUP BY DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy''), DW_PRCSS_ID' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_SOURCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS,'SELECT * FROM Data_Lake_df WHERE DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') = ''2018''' AS ADLS_QUERY_FOR_FIELD,'SELECT DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') AS CSTMR_ACCNT_CREATE_DATE, sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM Data_Lake_df GROUP BY DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy''),DW_PRCSS_ID' AS ADLS_QUERY_FOR_MEASURE
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_ACCOUNT_HIST' AS TABLE_NAME,'CSTMR_ACCNT_ID' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'CSTMR_ACCNT_CREATE_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'YEAR' AS PARTITION_ON,'SELECT to_char(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') AS CSTMR_ACCNT_CREATE_DATE, count(*) FROM WAREHOUSE.ADMIN.CUSTOMER_ACCOUNT_HIST GROUP BY to_char(CSTMR_ACCNT_CREATE_DATE, ''yyyy'')' AS PARTITION_QUERY_NETEZZA,'SELECT DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') AS CSTMR_ACCNT_CREATE_DATE, count(*) FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ACCOUNT_HIST/` GROUP BY DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'')' AS PARTITION_QUERY_SYNAPSE,'SELECT * FROM WAREHOUSE.ADMIN.CUSTOMER_ACCOUNT_HIST WHERE to_char(CSTMR_ACCNT_CREATE_DATE, ''YYYY'') = ''2018''' AS FIELD_VALIDATION_QUERY_NETEZZA,'SELECT * FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ACCOUNT_HIST/` WHERE DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') = ''2018''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') AS CSTMR_ACCNT_CREATE_DATE, sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM WAREHOUSE..CUSTOMER_ACCOUNT_HIST GROUP BY to_char(CSTMR_ACCNT_CREATE_DATE, ''yyyy''), DW_PRCSS_ID' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') AS CSTMR_ACCNT_CREATE_DATE,sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ACCOUNT/` GROUP BY DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy''), DW_PRCSS_ID' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_SOURCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS,'SELECT * FROM Data_Lake_df WHERE DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') = ''2018''' AS ADLS_QUERY_FOR_FIELD,'SELECT DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy'') AS CSTMR_ACCNT_CREATE_DATE, sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM Data_Lake_df GROUP BY DATE_FORMAT(CSTMR_ACCNT_CREATE_DATE, ''yyyy''),DW_PRCSS_ID' AS ADLS_QUERY_FOR_MEASURE


--PHONE_NUMBER 3331, 3332, 3333 corrected--
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'PHONE_NUMBER' AS TABLE_NAME,'ADDR_ID' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EFFCTV_DATE' AS PARTITION_COLUMN,'DK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, count(*) from WAREHOUSE..PHONE_NUMBER group by to_char(EFFCTV_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/PHONE_NUMBER` group by DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..PHONE_NUMBER where to_char(EFFCTV_DATE, ''yyyy Mon'') = ''2011 Dec''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/PHONE_NUMBER` where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2011 Dec''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EFFCTV_DATE,''yyyy Mon'') as EFFCTV_DATE, sum(DW_PRCSS_ID) as DW_PRCSS_ID,ADDR_SOURCE FROM WAREHOUSE..PHONE_NUMBER GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon''), ADDR_SOURCE' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE,''yyyy MMM'') as EFFCTV_DATE, sum(DW_PRCSS_ID) as DW_PRCSS_ID,ADDR_SOURCE FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/PHONE_NUMBER/` GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), ADDR_SOURCE' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'ADDR_SOURCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2011 Dec''' AS ADLS_QUERY_FOR_FIELD, 'SELECT DATE_FORMAT(EFFCTV_DATE,''yyyy MMM'') as EFFCTV_DATE, sum(DW_PRCSS_ID) as DW_PRCSS_ID,ADDR_SOURCE FROM Data_Lake_df GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), ADDR_SOURCE' AS ADLS_QUERY_FOR_MEASURE
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'PHONE_NUMBER' AS TABLE_NAME,'ADDR_SOURCE' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EFFCTV_DATE' AS PARTITION_COLUMN,'DK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, count(*) from WAREHOUSE..PHONE_NUMBER group by to_char(EFFCTV_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/PHONE_NUMBER` group by DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..PHONE_NUMBER where to_char(EFFCTV_DATE, ''yyyy Mon'') = ''2011 Dec''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/PHONE_NUMBER` where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2011 Dec''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EFFCTV_DATE,''yyyy Mon'') as EFFCTV_DATE, sum(DW_PRCSS_ID) as DW_PRCSS_ID,ADDR_SOURCE FROM WAREHOUSE..PHONE_NUMBER GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon''), ADDR_SOURCE' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE,''yyyy MMM'') as EFFCTV_DATE, sum(DW_PRCSS_ID) as DW_PRCSS_ID,ADDR_SOURCE FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/PHONE_NUMBER/` GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), ADDR_SOURCE' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'ADDR_SOURCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2011 Dec''' AS ADLS_QUERY_FOR_FIELD, 'SELECT DATE_FORMAT(EFFCTV_DATE,''yyyy MMM'') as EFFCTV_DATE, sum(DW_PRCSS_ID) as DW_PRCSS_ID,ADDR_SOURCE FROM Data_Lake_df GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), ADDR_SOURCE' AS ADLS_QUERY_FOR_MEASURE
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'PHONE_NUMBER' AS TABLE_NAME,'PREFERRED' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EFFCTV_DATE' AS PARTITION_COLUMN,'DK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, count(*) from WAREHOUSE..PHONE_NUMBER group by to_char(EFFCTV_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/PHONE_NUMBER` group by DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..PHONE_NUMBER where to_char(EFFCTV_DATE, ''yyyy Mon'') = ''2011 Dec''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/PHONE_NUMBER` where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2011 Dec''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EFFCTV_DATE,''yyyy Mon'') as EFFCTV_DATE, sum(DW_PRCSS_ID) as DW_PRCSS_ID,ADDR_SOURCE FROM WAREHOUSE..PHONE_NUMBER GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon''), ADDR_SOURCE' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE,''yyyy MMM'') as EFFCTV_DATE, sum(DW_PRCSS_ID) as DW_PRCSS_ID,ADDR_SOURCE FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/PHONE_NUMBER/` GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), ADDR_SOURCE' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'ADDR_SOURCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2011 Dec''' AS ADLS_QUERY_FOR_FIELD, 'SELECT DATE_FORMAT(EFFCTV_DATE,''yyyy MMM'') as EFFCTV_DATE, sum(DW_PRCSS_ID) as DW_PRCSS_ID,ADDR_SOURCE FROM Data_Lake_df GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), ADDR_SOURCE' AS ADLS_QUERY_FOR_MEASURE

--CUSTOMER_ADDRESS_HIST 1503,1504,1505,1506,1507 --
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_ADDRESS_HIST' AS TABLE_NAME,'ADDR_TYPE' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EFFCTV_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, count(*) from WAREHOUSE..CUSTOMER_ADDRESS_HIST group by to_char(EFFCTV_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST` group by DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..CUSTOMER_ADDRESS_HIST where to_char(EFFCTV_DATE, ''yyyy Mon'') = ''2013 Jul''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST` where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2013 Jul''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM WAREHOUSE..CUSTOMER_ADDRESS_HIST GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon''), DW_PRCSS_ID' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE,sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST/` GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''),DW_PRCSS_ID' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_ID' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df  where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2013 Jul''' AS [ADLS_QUERY_FOR_FIELD], 'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM Data_Lake_df GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), DW_PRCSS_ID' AS [ADLS_QUERY_FOR_MEASURE]
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_ADDRESS_HIST' AS TABLE_NAME,'CSTMR_ADDR_USE_TYPE' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EFFCTV_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, count(*) from WAREHOUSE..CUSTOMER_ADDRESS_HIST group by to_char(EFFCTV_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST` group by DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..CUSTOMER_ADDRESS_HIST where to_char(EFFCTV_DATE, ''yyyy Mon'') = ''2013 Jul''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST` where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2013 Jul''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM WAREHOUSE..CUSTOMER_ADDRESS_HIST GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon''), DW_PRCSS_ID' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE,sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST/` GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''),DW_PRCSS_ID' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_ID' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df  where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2013 Jul''' AS [ADLS_QUERY_FOR_FIELD], 'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM Data_Lake_df GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), DW_PRCSS_ID' AS [ADLS_QUERY_FOR_MEASURE]
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_ADDRESS_HIST' AS TABLE_NAME,'ADDR_ID' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EFFCTV_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, count(*) from WAREHOUSE..CUSTOMER_ADDRESS_HIST group by to_char(EFFCTV_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST` group by DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..CUSTOMER_ADDRESS_HIST where to_char(EFFCTV_DATE, ''yyyy Mon'') = ''2013 Jul''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST` where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2013 Jul''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM WAREHOUSE..CUSTOMER_ADDRESS_HIST GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon''), DW_PRCSS_ID' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE,sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST/` GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''),DW_PRCSS_ID' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_ID' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df  where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2013 Jul''' AS [ADLS_QUERY_FOR_FIELD], 'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM Data_Lake_df GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), DW_PRCSS_ID' AS [ADLS_QUERY_FOR_MEASURE]
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_ADDRESS_HIST' AS TABLE_NAME,'CSTMR_ID' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EFFCTV_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, count(*) from WAREHOUSE..CUSTOMER_ADDRESS_HIST group by to_char(EFFCTV_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST` group by DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..CUSTOMER_ADDRESS_HIST where to_char(EFFCTV_DATE, ''yyyy Mon'') = ''2013 Jul''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST` where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2013 Jul''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM WAREHOUSE..CUSTOMER_ADDRESS_HIST GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon''), DW_PRCSS_ID' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE,sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST/` GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''),DW_PRCSS_ID' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_ID' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df  where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2013 Jul''' AS [ADLS_QUERY_FOR_FIELD], 'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM Data_Lake_df GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), DW_PRCSS_ID' AS [ADLS_QUERY_FOR_MEASURE]
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_ADDRESS_HIST' AS TABLE_NAME,'EFFCTV_DATE' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EFFCTV_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, count(*) from WAREHOUSE..CUSTOMER_ADDRESS_HIST group by to_char(EFFCTV_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST` group by DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..CUSTOMER_ADDRESS_HIST where to_char(EFFCTV_DATE, ''yyyy Mon'') = ''2013 Jul''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST` where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2013 Jul''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM WAREHOUSE..CUSTOMER_ADDRESS_HIST GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon''), DW_PRCSS_ID' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE,sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS_HIST/` GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''),DW_PRCSS_ID' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_ID' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df  where DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2013 Jul''' AS [ADLS_QUERY_FOR_FIELD], 'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID FROM Data_Lake_df GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), DW_PRCSS_ID' AS [ADLS_QUERY_FOR_MEASURE]

 --WAREHOUSE.POSTAL_ADDRESS_HIST 3025,3026--
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'POSTAL_ADDRESS_HIST' AS TABLE_NAME,'EFFCTV_DATE' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EFFCTV_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'N' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'SELECT to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, FROM WAREHOUSE..POSTAL_ADDRESS_HIST GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, count(*) FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/POSTAL_ADDRESS_HIST/` GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'SELECT * FROM WAREHOUSE.ADMIN.POSTAL_ADDRESS_HIST WHERE to_char(EFFCTV_DATE, ''YYYY Mon'') = ''2010 Jul''' AS FIELD_VALIDATION_QUERY_NETEZZA,'SELECT * FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/POSTAL_ADDRESS_HIST/` WHERE DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2010 Jul''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, sum(ADDR_ID) as ADDR_ID,DW_PRCSS_ID,ADDR_TYPE FROM WAREHOUSE..POSTAL_ADDRESS_HIST GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon''),DW_PRCSS_ID,ADDR_TYPE' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, sum(ADDR_ID) as ADDR_ID,DW_PRCSS_ID,ADDR_TYPE FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/POSTAL_ADDRESS_HIST/` GROUP BY  DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''),DW_PRCSS_ID,ADDR_TYPE' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'ADDR_ID' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS,'SELECT * FROM Data_Lake_df WHERE DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2010 Jul''' AS ADLS_QUERY_FOR_FIELD,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE,sum(ADDR_ID) as ADDR_ID,DW_PRCSS_ID,ADDR_TYPE FROM Data_Lake_df GROUP BY  DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), DW_PRCSS_ID,ADDR_TYPE' AS ADLS_QUERY_FOR_MEASURE
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'POSTAL_ADDRESS_HIST' AS TABLE_NAME,'ADDR_ID' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EFFCTV_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'N' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'SELECT to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, FROM WAREHOUSE..POSTAL_ADDRESS_HIST GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, count(*) FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/POSTAL_ADDRESS_HIST/` GROUP BY DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'SELECT * FROM WAREHOUSE.ADMIN.POSTAL_ADDRESS_HIST WHERE to_char(EFFCTV_DATE, ''YYYY Mon'') = ''2010 Jul''' AS FIELD_VALIDATION_QUERY_NETEZZA,'SELECT * FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/POSTAL_ADDRESS_HIST/` WHERE DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2010 Jul''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EFFCTV_DATE, ''yyyy Mon'') AS EFFCTV_DATE, sum(ADDR_ID) as ADDR_ID,DW_PRCSS_ID,ADDR_TYPE FROM WAREHOUSE..POSTAL_ADDRESS_HIST GROUP BY to_char(EFFCTV_DATE, ''yyyy Mon''),DW_PRCSS_ID,ADDR_TYPE' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE, sum(ADDR_ID) as ADDR_ID,DW_PRCSS_ID,ADDR_TYPE FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/POSTAL_ADDRESS_HIST/` GROUP BY  DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''),DW_PRCSS_ID,ADDR_TYPE' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'ADDR_ID' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS,'SELECT * FROM Data_Lake_df WHERE DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') = ''2010 Jul''' AS ADLS_QUERY_FOR_FIELD,'SELECT DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM'') AS EFFCTV_DATE,sum(ADDR_ID) as ADDR_ID,DW_PRCSS_ID,ADDR_TYPE FROM Data_Lake_df GROUP BY  DATE_FORMAT(EFFCTV_DATE, ''yyyy MMM''), DW_PRCSS_ID,ADDR_TYPE' AS ADLS_QUERY_FOR_MEASURE

--CUSTOMER_HIST 1517, 1518--
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_HIST' AS TABLE_NAME,'CSTMR_ID' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'CSTMR_FIRST_VISIT_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(CSTMR_FIRST_VISIT_DATE, ''yyyy Mon'') AS CSTMR_FIRST_VISIT_DATE, count(*) from WAREHOUSE..CUSTOMER_HIST group by to_char(CSTMR_FIRST_VISIT_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'') AS CSTMR_FIRST_VISIT_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_HIST` group by DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..CUSTOMER_HIST where to_char(CSTMR_FIRST_VISIT_DATE, ''yyyy Mon'') = ''2003 Feb''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_HIST` where DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'') = ''2003 Feb''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(CSTMR_FIRST_VISIT_DATE, ''yyyy Mon'') AS CSTMR_FIRST_VISIT_DATE, sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM WAREHOUSE..CUSTOMER_HIST GROUP BY to_char(CSTMR_FIRST_VISIT_DATE, ''yyyy Mon''), DW_PRCSS_ID' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'') AS CSTMR_FIRST_VISIT_DATE, sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_HIST/` GROUP BY DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM''), DW_PRCSS_ID' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_SOURCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS,'select * from Data_Lake_df where DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'') = ''2003 Feb''' AS [ADLS_QUERY_FOR_FIELD],'SELECT DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'') AS CSTMR_FIRST_VISIT_DATE, sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM Data_Lake_df GROUP BY DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM''),DW_PRCSS_ID' AS [ADLS_QUERY_FOR_MEASURE]
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_HIST' AS TABLE_NAME,'EFFCTV_DATE' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'CSTMR_FIRST_VISIT_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(CSTMR_FIRST_VISIT_DATE, ''yyyy Mon'') AS CSTMR_FIRST_VISIT_DATE, count(*) from WAREHOUSE..CUSTOMER_HIST group by to_char(CSTMR_FIRST_VISIT_DATE, ''yyyy Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'') AS CSTMR_FIRST_VISIT_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_HIST` group by DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..CUSTOMER_HIST where to_char(CSTMR_FIRST_VISIT_DATE, ''yyyy Mon'') = ''2003 Feb''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_HIST` where DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'') = ''2003 Feb''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(CSTMR_FIRST_VISIT_DATE, ''yyyy Mon'') AS CSTMR_FIRST_VISIT_DATE, sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM WAREHOUSE..CUSTOMER_HIST GROUP BY to_char(CSTMR_FIRST_VISIT_DATE, ''yyyy Mon''), DW_PRCSS_ID' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'') AS CSTMR_FIRST_VISIT_DATE, sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_HIST/` GROUP BY DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM''), DW_PRCSS_ID' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_SOURCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS,'select * from Data_Lake_df where DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'') = ''2003 Feb''' AS [ADLS_QUERY_FOR_FIELD],'SELECT DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM'') AS CSTMR_FIRST_VISIT_DATE, sum(CSTMR_SOURCE) as CSTMR_SOURCE,DW_PRCSS_ID FROM Data_Lake_df GROUP BY DATE_FORMAT(CSTMR_FIRST_VISIT_DATE, ''yyyy MMM''),DW_PRCSS_ID' AS [ADLS_QUERY_FOR_MEASURE]

--CUSTOMER_ADDRESS 2777 corrected--
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_ADDRESS' AS TABLE_NAME,'ADDR_ID' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'EXPRTN_DATE' AS PARTITION_COLUMN,'DK' AS KEY_TYPE,'N' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'SELECT to_char(EXPRTN_DATE, ''YYYY Mon'') as EXPRTN_DATE,count(*) FROM WAREHOUSE..CUSTOMER_ADDRESS  group by to_char(EXPRTN_DATE, ''YYYY Mon'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(EXPRTN_DATE, ''yyyy MMM'') as EXPRTN_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS` group by DATE_FORMAT(EXPRTN_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..CUSTOMER_ADDRESS where to_char(EXPRTN_DATE, ''YYYY Mon'')=''2022 Dec''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS` where DATE_FORMAT(EXPRTN_DATE, ''yyyy MMM'')=''2022 Dec''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(EXPRTN_DATE, ''YYYY Mon'') as EXPRTN_DATE, sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID,ADDR_TYPE FROM WAREHOUSE..CUSTOMER_ADDRESS GROUP BY to_char(EXPRTN_DATE, ''YYYY Mon''),DW_PRCSS_ID,ADDR_TYPE' AS MEASURE_QUERY_NETEZZA,'SELECT DATE_FORMAT(EXPRTN_DATE, ''yyyy MMM'') as EXPRTN_DATE,sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID,ADDR_TYPE FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_ADDRESS/` GROUP BY  DATE_FORMAT(EXPRTN_DATE, ''yyyy MMM''),DW_PRCSS_ID,ADDR_TYPE' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS, 'CSTMR_ID' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df where DATE_FORMAT(EXPRTN_DATE, ''YYYY Mon'')=''2022 Dec''' AS ADLS_QUERY_FOR_FIELD, 'SELECT DATE_FORMAT(EXPRTN_DATE, ''yyyy MMM'') as EXPRTN_DATE,sum(CSTMR_ID) as CSTMR_ID,DW_PRCSS_ID,ADDR_TYPE FROM Data_Lake_df GROUP BY DATE_FORMAT(EXPRTN_DATE, ''yyyy MMM''),DW_PRCSS_ID,ADDR_TYPE' AS ADLS_QUERY_FOR_MEASURE

--POSTAL_ADDRESS--
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],	'ADMIN' AS [SCHEMA], 'POSTAL_ADDRESS' AS TABLE_NAME, 'ADDR_TYPE' AS KEY_COLUMN,	'Y' AS ACTIVE_FLAG,	'MOVE_EFFECTIVE_DATE' AS PARTITION_COLUMN, 'PK' AS KEY_TYPE,'Y' AS KEY_TYPE, 'YEAR' AS PARTITION_ON,'SELECT to_char(MOVE_EFFECTIVE_DATE, ''YYYY'') AS MOVE_EFFECTIVE_DATE,COUNT(*) as CNT FROM WAREHOUSE_DR.ADMIN.POSTAL_ADDRESS GROUP BY to_char(MOVE_EFFECTIVE_DATE, ''YYYY'')' AS PARTITION_QUERY_NETEZZA,'SELECT MOVE_EFFECTIVE_DATE, count(*) FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/POSTAL_ADDRESS/` GROUP BY MOVE_EFFECTIVE_DATE' AS PARTITION_QUERY_SYNAPSE,'SELECT * FROM WAREHOUSE.ADMIN.POSTAL_ADDRESS WHERE to_char(MOVE_EFFECTIVE_DATE, ''YYYY'') = ''2019''' AS FIELD_VALIDATION_QUERY_NETEZZA, 'SELECT * FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/POSTAL_ADDRESS/` WHERE DATE_FORMAT(MOVE_EFFECTIVE_DATE, ''yyyy'') = ''2019'''  AS FIELD_VALIDATION_QUERY_SYNAPSE, 'SELECT to_char(MOVE_EFFECTIVE_DATE,''YYYY'') AS MOVE_EFFECTIVE_DATE,SUM(MOVE_DISTANCE) AS MOVE_DISTANCE FROM WAREHOUSE_DR.ADMIN.POSTAL_ADDRESS GROUP BY to_char(MOVE_EFFECTIVE_DATE,''YYYY'')' AS MEASURE_QUERY_NETEZZA, 'SELECT DATE_FORMAT(MOVE_EFFECTIVE_DATE,''yyyy'') AS MOVE_EFFECTIVE_DATE,SUM(MOVE_DISTANCE) AS MOVE_DISTANCE FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/POSTAL_ADDRESS/` GROUP BY DATE_FORMAT(MOVE_EFFECTIVE_DATE,''yyyy'')' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'MOVE_DISTANCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'SELECT * from Data_Lake_df WHERE DATE_FORMAT(MOVE_EFFECTIVE_DATE, ''y'') =''2023'''  AS [ADLS_QUERY_FOR_FIELD], 'SELECT DATE_FORMAT(MOVE_EFFECTIVE_DATE, ''y'') AS MOVE_EFFECTIVE_DATE, SUM(MOVE_DISTANCE) AS MOVE_DISTANCE FROM Data_Lake_df GROUP BY DATE_FORMAT(MOVE_EFFECTIVE_DATE, ''y'')'  AS [ADLS_QUERY_FOR_MEASURE]	

--CUSTOMER_REGISTRATION 1525--
UNION ALL SELECT 'WAREHOUSE' AS [DATABASE],'ADMIN' AS [SCHEMA],'CUSTOMER_REGISTRATION' AS TABLE_NAME,'CSTMR_ID' AS KEY_COLUMN,'Y' AS ACTIVE_FLAG,'RGSTRD_DATE' AS PARTITION_COLUMN,'PK' AS KEY_TYPE,'Y' AS KEY_TYPE_UNIQUE,'MONTH' AS PARTITION_ON,'select to_char(RGSTRD_DATE, ''yyyy MMM'') AS RGSTRD_DATE, count(*) from WAREHOUSE..CUSTOMER_REGISTRATION group by to_char(RGSTRD_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_NETEZZA,'select DATE_FORMAT(RGSTRD_DATE, ''yyyy MMM'') AS RGSTRD_DATE, count(*) from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_REGISTRATION` group by DATE_FORMAT(RGSTRD_DATE, ''yyyy MMM'')' AS PARTITION_QUERY_SYNAPSE,'select * from WAREHOUSE..CUSTOMER_REGISTRATION where to_char(RGSTRD_DATE, ''yyyy Mon'') = ''2017 Nov''' AS FIELD_VALIDATION_QUERY_NETEZZA,'select * from delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_REGISTRATION` where DATE_FORMAT(RGSTRD_DATE, ''yyyy MMM'') = ''2017 Nov''' AS FIELD_VALIDATION_QUERY_SYNAPSE,'SELECT to_char(RGSTRD_DATE, ''yyyy MMM'') AS RGSTRD_DATE,sum(CSTMR_RGSTRD_SOURCE) as CSTMR_RGSTRD_SOURCE,HR_ID FROM WAREHOUSE..CUSTOMER_REGISTRATION GROUP BY to_char(RGSTRD_DATE, ''yyyy MMM''), HR_ID' AS MEASURE_QUERY_NETEZZA,'SELECT to_char(RGSTRD_DATE, ''yyyy MMM'') AS RGSTRD_DATE,sum(CSTMR_RGSTRD_SOURCE) as CSTMR_RGSTRD_SOURCE,HR_ID FROM delta.`/mnt/silver/WAREHOUSE/ADMIN/CUSTOMER_REGISTRATION/` GROUP BY to_char(RGSTRD_DATE, ''yyyy MMM''), HR_ID' AS MEASURE_QUERY_SYNAPSE,NULL AS PARTITON_QUERY_NETEZZA_SYNAPSE_SEVEN_YEARS,'CSTMR_RGSTRD_SOURCE' AS MEASURE_COLUMN,NULL AS MEASURE_QUERY_NETEZZA_SEVEN_YEARS,NULL AS MEASURE_QUERY_SYNAPSE_SEVEN_YEARS, 'select * from Data_Lake_df where DATE_FORMAT(RGSTRD_DATE, ''yyyy MMM'') = ''2017 Nov''' AS [ADLS_QUERY_FOR_FIELD], 'SELECT DATE_FORMAT(RGSTRD_DATE, ''yyyy MMM'') AS RGSTRD_DATE, sum(CSTMR_RGSTRD_SOURCE) as CSTMR_RGSTRD_SOURCE,HR_ID FROM Data_Lake_df GROUP BY DATE_FORMAT(RGSTRD_DATE, ''yyyy MMM''),HR_ID' AS [ADLS_QUERY_FOR_MEASURE]

